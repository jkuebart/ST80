'From Smalltalk-80 of March 19, 1982 on 11 April 1982 at 10:52:28 am;Modified from CV4 for DV5 by Evelyn Van Orden on 7 May 1986'!!Form methodsFor: 'displaying'!withinSelfMove: sourceRect to: aPoint rule: ruleInteger	self copyBits: sourceRect		from: self		at: aPoint		clippingBox: self computeBoundingBox		rule: ruleInteger		mask: Form black! !!DisplayScreen methodsFor: 'special effects'!dancingBits	"Displays hypnotic dancing bits special effects using BitBlt.	Press a key or mouse button to stop."	"Display dancingBits."	| sourceRect bitsArray size points i | 	Display white.	sourceRect _ self computeBoundingBox.	bitsArray _ self defaultBitsArray.	size _ bitsArray first size.	points _ Array new: size.	1 to: size do: [:i | points at: i put: (bitsArray first at: i) @ (bitsArray last at: i)].	i _ 0.	Cursor blank showWhile:	[[Sensor keyboardPressed | Sensor anyButtonPressed] whileFalse: 		[(i _ i + 1) > size ifTrue: [i _ 1].		self withinSelfMove: sourceRect to: (points at: i)*2 rule: 12.		self withinSelfMove: sourceRect to: (points at: i)*2 rule: 12]].	Cursor normal show.	[Sensor keyboardPressed] whileTrue: [Sensor keyboard].	ScheduledControllers restore!dancingBits2	"A variation of dancingBits.	Press a key or mouse button to stop."	"Display dancingBits."	| sourceRect bitsArray size points new old i | 	Display white.	sourceRect _ self computeBoundingBox.	bitsArray _ self defaultBitsArray.	size _ bitsArray first size.	points _ Array new: size.	1 to: size do: [:i | points at: i put: (bitsArray first at: i) @ (bitsArray last at: i)].	i _ 0.	old _ points at: size.	Cursor blank showWhile:	[[Sensor keyboardPressed | Sensor anyButtonPressed] whileFalse: 		[(i _ i + 1) > points size ifTrue: [i _ 1].		new _ points at: i.		self withinSelfMove: sourceRect to: old+new//2 rule: 12.		self withinSelfMove: sourceRect to: new rule: 12.		old _ new]].	Cursor normal show.	[Sensor keyboardPressed] whileTrue: [Sensor keyboard].	ScheduledControllers restore!defaultBitsArray	^Array		with: #(-15 -15 -14 -14 -14 -13 -12 -11 -10 -9 -8 -7 -6 -5 -4 -4 -3 -3 -2 -2 -2 -2 -1 -1 0 0 0 1 1 1 1 2 3 4 4 5 5 5 6 6 6 7 7 7 7 8 8 8 8 9 9 9 9 10 10 10 11 11 11 8 8 8 8 8 8 8 7 7 7 7 7 7 7 7 7 6 6 6 6 6 5 5 5 5 4 4 3 3 3 3 2 2 2 1 1 0 0 -1 -1 -1 -2 -2 -3 -3 -3 -4 -4 -5 -5 -6 -6 -7 -8 -9 -10 -10 -11 -11 -12 -12 -13 -13 -13 -13 -14 -14 -14 -15 -15 -15 -16 -16 -17 -17 -18 -18 -19 -20 -20 -21 -21 -21 -21 -21 -21 -21 -21 -21 -21 -21 -21 -21 -21 -20 -20 -20 -19 -19 -18 -18 -18 -17 -16 -16 -15 -14 -13 -12 -11 -11 -10 -10 -10 -9 -8 -7 -7 -7)		with: #(5 6 6 6 7 8 8 9 9 10 11 11 12 12 12 12 13 13 13 13 13 13 13  13 13 13 13 13 13 13 13 13 13 12 12 11 11 10 10 10 9 9 8 8 7 7 7 7 6 6 6 6 5 5 5 5 5 5 5 5 5 5 5 5 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 5 5 6 6 7 7 8 8 8 8 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 8 8 8 7 7 6 6 5 5 5 4 4 3 3 2 2 2 2 1 1 1 1 1 0 0 -1 -2 -3 -4 -5 -5 -4 -3 -2 -1 0 0 1 1 1 2 2 2 3 3 3 4 4 4)!feedBack	"Displays video feedback special effects using BitBlt.	Specify a rectangle. Watch what happens when you move the mouse.	Press a key or mouse button to stop."	"Display feedBack."	| sourceRect | 	sourceRect _ Rectangle fromUser.	[Sensor keyboardPressed | Sensor anyButtonPressed] whileFalse: 		[self withinSelfMove: sourceRect to: Sensor mousePoint rule: 12].	[Sensor keyboardPressed] whileTrue: [Sensor keyboard].	ScheduledControllers restore! !