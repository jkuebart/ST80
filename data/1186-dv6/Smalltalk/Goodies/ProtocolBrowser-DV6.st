'Unmodified from LV4 (interface-protocol.st) for CV4 by Evelyn Van Orden on 7 December 1983'!Object subclass: #ProtocolBrowser	instanceVariableNames: 'list classDictionary selectedClass selectedSelector '	classVariableNames: ''	poolDictionaries: ''	category: 'Interface-Protocol'!!ProtocolBrowser methodsFor: 'private'!on: aClass	"Create the protocol browser for the class, a Class."	| defClass |	list _ OrderedCollection new.	classDictionary _ Dictionary new.	aClass allSelectors asSortedCollection do:		[ :selector |		 defClass _ aClass whichClassIncludesSelector: selector.		 list add: selector printString, '	(' , defClass name , ')'.		 classDictionary add: (Association key: selector value: defClass)]! !!ProtocolBrowser methodsFor: 'list access'!selector: aString	aString == nil		ifTrue: [selectedSelector _ aString. ^self].	selectedSelector _ (aString copyUpTo: Character tab) asSymbol.	selectedClass _ classDictionary at: selectedSelector.	self changed: #text!selectorList	^list!selectorListMenu	selectedSelector isNil		ifTrue: [^nil]		ifFalse: [^ActionMenu			labels: 'senders\implementors\messages' withCRs			lines: #()			selectors: #(browseSenders browseImplementors browseMessages)]! !!ProtocolBrowser methodsFor: 'list functions'!browseImplementors	Smalltalk browseAllImplementorsOf: selectedSelector!browseMessages	Smalltalk showMenuThenBrowse:		(selectedClass compiledMethodAt: selectedSelector)			messages asSortedCollection!browseSenders	Smalltalk browseAllCallsOn: selectedSelector! !!ProtocolBrowser methodsFor: 'text access'!acceptText: aText from: aController	| newSelector |	newSelector _ selectedClass				compile: aText				classified: (selectedClass organization categoryOfElement: selectedSelector)				notifying: aController.	newSelector == nil ifTrue: [^false].	newSelector == selectedSelector		ifFalse: [self newSelectorList: newSelector].	^true!text	selectedSelector == nil		ifTrue: [^'' asText].	^(selectedClass sourceCodeAt: selectedSelector) asText makeSelectorBoldIn: selectedClass!textMenu	^ActionMenu			labels: 'again\undo\copy\cut\paste\do it\print it\accept\cancel' withCRs			lines: #(2 5 7)			selectors: #(again undo copySelection cut paste doIt printIt accept cancel)! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!ProtocolBrowser class	instanceVariableNames: ''!!ProtocolBrowser class methodsFor: 'instance creation'!openForClass: aClass	"Create and schedule a browser for the entire protocol of the class."	| topView aPBrowser label |	aPBrowser _ ProtocolBrowser new on: aClass.	label _ 'Entire protocol of: ', aClass name.	topView _ StandardSystemView model: aPBrowser label: label minimumSize: 200 @ 200.	topView addSubView:			(SelectionInListView on: aPBrowser aspect: #selector change: #selector:				list: #selectorList menu: #selectorListMenu initialSelection: nil)		in: (0@0.0 extent: 1@0.3) borderWidth: 1.	topView addSubView:			(CodeView on: aPBrowser aspect: #text change: #acceptText:from:				menu: #textMenu initialSelection: nil)		in: (0@0.3 extent: 1@0.7) borderWidth: 1.	topView controller open	"ProtocolBrowser openForClass: ProtocolBrowser"! !